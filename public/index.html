<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dashboard | Monitor BTC/USDT</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="app">
    <aside class="sidebar">
      <div class="profile" data-tip="Painel lateral com navega√ß√£o.">
        <div class="avatar">‚Çø</div>
        <div class="who">
          <span class="hello">Hi, Trader</span>
          <small class="muted">Crypto Monitor</small>
        </div>
      </div>
      <nav class="nav">
        <div class="nav-group">
          <a class="nav-item active" href="#" data-tip="Vis√£o geral do dashboard."><span class="ico">‚ñ£</span>Dashboard</a>
          <a class="nav-item" href="#" data-tip="Resumo e atalhos."><span class="ico">‚ò∞</span>Overview</a>
          <a class="nav-item" href="#" data-tip="Estat√≠sticas e relat√≥rios."><span class="ico">‚åÅ</span>Statistics</a>
          <a class="nav-item" href="#" data-tip="Configura√ß√µes do sistema."><span class="ico">‚öô</span>Settings</a>
        </div>
        <div class="nav-sep"></div>
        <div class="nav-group">
          <a class="nav-item" href="#" data-tip="Contatos e suporte."><span class="ico">‚úâ</span>Contact</a>
        </div>
      </nav>
      <button class="btn upgrade" data-tip="Funcionalidades premium (exemplo).">Upgrade</button>
    </aside>

    <main class="main">
      <header class="topbar card">
        <div class="title">
          <button class="hamb" aria-label="Menu" data-tip="Menu de navega√ß√£o.">‚ò∞</button>
          <h1>Dashboard</h1>
        </div>
        <div class="search-wrap">
          <input class="search" type="text" placeholder="Searching" data-tip="Pesquisa (n√£o funcional nesta vers√£o)." />
          <div class="icons">
            <span data-tip="Notifica√ß√µes.">üîî</span>
            <span data-tip="Prefer√™ncias.">‚öô</span>
          </div>
        </div>
      </header>

      <section class="status-line card">
        <div class="status-item" data-tip="Estado da conex√£o com a Binance.">
          <span class="label">Conex√£o</span>
          <span id="wsStatus" class="badge">Offline</span>
        </div>
        <div class="status-item" data-tip="Lat√™ncia estimada da atualiza√ß√£o.">
          <span class="label">Lat√™ncia</span>
          <span><strong id="latency">-</strong> ms</span>
        </div>
        <div class="status-item" data-tip="Hor√°rio do √∫ltimo tick recebido.">
          <span class="label">√öltimo tick</span>
          <span><strong id="lastTick">-</strong></span>
        </div>
      </section>

      <section class="kpi-row">
        <div class="kpi card kpi-green" data-tip="Pre√ßo negociado em tempo real (aggTrade).">
          <div class="kpi-head"><span class="muted">Pre√ßo atual</span></div>
          <div id="price" class="kpi-val">-</div>
          <div class="kpi-foot"><span class="chip chip-up">live</span></div>
        </div>
        <div class="kpi card kpi-blue" data-tip="Maior pre√ßo desde o √∫ltimo reset/novo topo.">
          <div class="kpi-head"><span class="muted">Pico recente</span></div>
          <div class="kpi-val"><span id="peak">-</span></div>
          <div class="kpi-foot"><span class="muted">h√° <strong id="peakAge">‚Äî</strong></span></div>
        </div>
        <div class="kpi card kpi-violet" data-tip="Varia√ß√£o com sinal vs. Pico: verde acima, vermelho abaixo.">
          <div class="kpi-head"><span class="muted">Drawdown</span></div>
          <div id="drawdown" class="kpi-val">-</div>
          <div class="kpi-foot"><span class="muted">vs. pico</span></div>
        </div>
      </section>

      <section class="middle">
        <div class="panel card" data-tip="Gr√°fico dos √∫ltimos ticks.">
          <div class="panel-head">
            <h3>Pre√ßo ‚Äì √öltimos ticks</h3>
            <div class="chart-controls">
              <label class="muted" data-tip="Tipo de gr√°fico.">Tipo</label>
              <select id="chartType" data-tip="Trocar entre Linha, √Årea e Barra.">
                <option value="line" selected>Linha</option>
                <option value="area">√Årea</option>
                <option value="bar">Barra</option>
              </select>
              <label class="muted" data-tip="Janela de ticks usada no gr√°fico e tend√™ncia.">Tempo gr√°fico</label>
              <select id="trendWindow" data-tip="Quantidade de pontos para an√°lise e exibi√ß√£o.">
                <option value="60" selected>60</option>
                <option value="120">120</option>
                <option value="240">240</option>
              </select>
            </div>
          </div>
          <div class="chart-area">
            <canvas id="priceChart"></canvas>
          </div>
          <div class="panel-foot"><span class="muted">Atualiza em tempo real</span></div>
        </div>

        <div class="panel card" data-tip="Eventos e atividades recentes.">
          <div class="panel-head"><h3>Recent Activity</h3></div>
          <ul class="activity">
            <li><span class="ico-bullet">‚¨§</span>Conex√£o de stream inicializada</li>
            <li><span class="ico-bullet">‚¨§</span>Alertas exibidos aqui conforme ocorrem</li>
          </ul>
          <ul id="events" class="events"></ul>
        </div>
      </section>

      <section class="grid-2">
        <div class="card" data-tip="Configura√ß√£o dos alertas.">
          <div class="panel-head"><h3>Data input</h3></div>
          <div class="form-grid">
            <label data-tip="M√≠nimo do intervalo de drawdown absoluto para alertar.">M√≠n (%)<input id="minThreshold" type="number" step="0.1" value="2.5" /></label>
            <label data-tip="M√°ximo do intervalo de drawdown absoluto para alertar.">M√°x (%)<input id="maxThreshold" type="number" step="0.1" value="3" /></label>
            <label data-tip="Tempo para reset autom√°tico do pico.">Reset (min)<input id="resetWindow" type="number" step="1" value="60" /></label>
            <label data-tip="Par da Binance (min√∫sculas).">S√≠mbolo<input id="symbol" type="text" value="btcusdt" /></label>
            <div class="form-actions">
              <button id="apply" class="btn" data-tip="Aplicar s√≠mbolo e thresholds.">Aplicar</button>
              <button id="resetPeak" class="btn btn-soft" data-tip="Reset manual do pico para o pre√ßo atual.">Resetar Pico</button>
              <button id="mute" class="btn btn-soft" data-tip="Ativar/desativar som dos alertas.">Silenciar</button>
            </div>
          </div>
        </div>

        <div class="card" data-tip="Tend√™ncia por regress√£o linear dos √∫ltimos N pre√ßos.">
          <div class="panel-head"><h3>Tend√™ncia</h3></div>
          <div class="trend-block">
            <div class="trend-line">
              <span id="trendLabel" class="trend-label" data-tip="Alta ‚¨Ü quando inclina√ß√£o > threshold; Baixa ‚¨á quando < -threshold; caso contr√°rio Neutra.">Neutra</span>
              <small id="trendScore" class="muted" data-tip="Score = inclina√ß√£o normalizada em % por amostra.">0.0000</small>
            </div>
            <small class="muted" id="trendWindowInfo" data-tip="Tempo gr√°fico atual (N pontos).">Janela: 60</small>
          </div>
        </div>
      </section>

      <!-- Diagn√≥stico -->
      <section class="grid-2">
        <div class="card" data-tip="Diagn√≥stico de conex√£o e erros.">
          <div class="panel-head"><h3>Diagn√≥stico</h3></div>
          <div class="results">
            <div class="res-row"><span class="muted">Endpoint</span><strong id="diagEndpoint">-</strong></div>
            <div class="res-row"><span class="muted">Estado</span><strong id="diagState">Offline</strong></div>
            <div class="res-row"><span class="muted">√öltimo erro</span><span id="diagError" class="muted">-</span></div>
            <div class="res-row"><span class="muted">Evento</span><span id="diagEvent" class="muted">-</span></div>
            <div class="res-row"><span class="muted">Tentativas</span><strong id="diagAttempts">0</strong></div>
            <div class="res-row"><span class="muted">√öltimo tick</span><strong id="diagLastTick">-</strong></div>
          </div>
        </div>

        <div class="card" data-tip="Resultados calculados a partir dos custos.">
          <div class="panel-head"><h3>Resultados</h3></div>
          <div class="results">
            <div class="res-row"><span class="muted">Custo total</span><strong id="totalCost">-</strong></div>
            <div class="res-row"><span class="muted">Breakeven</span><strong id="breakeven">-</strong></div>
            <div class="res-row"><span class="muted">Obs</span><span id="breakevenNote" class="muted" data-tip="Use ordens limit para reduzir slippage.">Use ordens limit para reduzir slippage.</span></div>
          </div>
        </div>
      </section>

      <section class="card" data-tip="Somente picos finalizados com dura√ß√£o > 10s s√£o registrados.">
        <div class="panel-head">
          <h3>Picos recentes</h3>
          <div class="actions">
            <!-- IDs necess√°rios pelo app.js -->
            <button id="exportPeaks" class="btn-soft" data-tip="Exportar hist√≥rico em CSV.">Exportar CSV</button>
            <button id="savePeaks" class="btn-soft" data-tip="Salvar edi√ß√µes na tabela.">Salvar edi√ß√µes</button>
            <button id="clearPeaks" class="btn-soft" data-tip="Limpar hist√≥rico.">Limpar</button>
          </div>
        </div>
        <div class="table-wrap">
          <table class="table">
            <thead>
              <tr>
                <th data-tip="Hor√°rio de registro do pico.">Data/Hora</th>
                <th data-tip="Pre√ßo do pico.">Pre√ßo</th>
                <th data-tip="Tempo total (Dura√ß√£o) do pico.">Dura√ß√£o</th>
                <th data-tip="Maior drawdown observado desde o pico.">DD m√°x</th>
                <th data-tip="Origem do pico (manual/auto/novo topo).">Origem</th>
              </tr>
            </thead>
            <tbody id="peaksBody"></tbody>
          </table>
        </div>
        <small class="muted">Registra apenas picos finalizados com dura√ß√£o > 10s.</small>
      </section>

      <footer class="footer muted" data-tip="Aviso legal.">Informativo. N√£o executa ordens.</footer>
    </main>
  </div>

  <audio id="beep" src="data:audio/wav;base64,UklGRoQAAABXQVZFZm10IBAAAAABAAEAESsAACJWAAACABAAZGF0YQAAAAA=" preload="auto"></audio>

  <!-- Chart.js CDN ANTES do app.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <script src="app.js"></script>
</body>
</html>